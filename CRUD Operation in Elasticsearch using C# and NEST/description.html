<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=2B83EB0C693B7557DED3269FD76B3864" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=2118F9E22ED5006F07B68F92F44A0CDA" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>CRUD Operation in Elasticsearch using C# and NEST</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>CRUD Operation in Elasticsearch using C# and NEST</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, JSON, ES, Elasticsearch
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            C#, JSON, ES, Elasticsearch
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Cloud, Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">8/8/2016</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MIT</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/CRUD-Operation-in-d8033948">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h2>Introduction</h2>
<p><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">In
 our previous artilce. </span></p>
<ul>
<li><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12.9px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; color:#0076a3; background-color:#ffffff"><a href="http://social.technet.microsoft.com/wiki/contents/articles/34476.searching-data-in-elasticsearch-using-c.aspx"  style="margin:0px; padding:0px; outline:0px; border:currentcolor; color:#0076a3; line-height:16.12px; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; font-size:12px; list-style-type:none; background-color:#ffffff">Searching
 data in Elasticsearch using C# </a></span></li></ul>
<p><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">We
 have seen in details about Elasticsearch, how to configure and perform a search operation.
</span></p>
<p>In this article we will see how to do CRUD (Create/Read/Update and Delete) operation in Elasticsearch using C# and NEST (.NET client for Elasticsearch). The example is made of C# use under WinForm. This article is specially focusing on newcomers and anyone
 new wants to learn or thinking of using ES in their .NET program. This sample illustrates a way to let user to perform CRUD operation in Elasticsearch from their WinForm app.</p>
<p><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">In
 this article we are going to see how we can, </span></p>
<ul>
<li><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">Create
 a document in Elasticsearch </span></li><li><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">Setup
 our development enviroment </span></li><li><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">How
 we can Insert data to ES </span></li><li><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">How
 we can Search data in ES </span></li><li><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">How
 we can Update data in ES </span></li><li><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">How
 we can Delete data in ES </span></li></ul>
<h2>Getting Started</h2>
<p><img id="157969" src="description/SE003.PNG" alt="" width="800" height="388"></p>
<p><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">Before
 we start writing code we must to reference NEST in our project, that of making libraries accessible to the solution.</span></p>
<p><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">&nbsp;</span><span style="font-size:1.17em"><strong>Referencing
 NEST</strong></span></p>
<p><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">As
 discussed in the previous article, first we need to download the .NET client for Elasticsearch which is
<a href="https://code.msdn.microsoft.com/CRUD-Operation-in-d8033948/https://github.com/elastic/elasticsearch-net"  style="margin:0px; padding:0px; outline:0px; border:currentcolor; color:#0076a3; line-height:16.12px; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; font-size:12px; list-style-type:none; background-color:#ffffff">
NEST</a>. To reference NEST within our project,that is make its libraries accessible to the solution, use the Nuget Package Manager Console Window to run the below command to install the NEST client
</span></p>
<ul>
<li><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">PM&gt;
 Install-Package NEST </span></li></ul>
<p><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">When
 finished, we will see project References included the references those related to NEST.
<br>
<br>
<a href="http://social.technet.microsoft.com/wiki/cfs-file.ashx/__key/communityserver-wikis-components-files/00-00-00-00-05/8715.devSetup01.png"><img src="description/8715.devSetup01.png-350x0.png" alt="" style="border-width:0px; border-style:solid"></a><br>
</span></p>
<p><span style="margin:0px; padding:0px; outline:0px; line-height:16.12px; font-size:12px; font-style:inherit; font-weight:inherit; list-style-type:none; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; background-color:#ffffff">We
 are now ready to use the Elasticsearch NEST client regarding the development of our CRUD.
</span></p>
<h2>Sample Data</h2>
<p>You could use the attached data in the project folder and do a bulk insert into ES or you can use your own data. If you use you own data please change the index name in the GetDocument.cs code to your index name and type to your type name. Also you need
 to update the response model in DocumentAttributes.cs and UpdateDocumentAttributes.cs
<br>
<br>
<br>
Sample code will be look like as follows</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">public static DataTable getAllDocument()
        {
            DataTable dataTable = new DataTable(&quot;character&quot;);
            dataTable.Columns.Add(&quot;ID&quot;, typeof(string));
            dataTable.Columns.Add(&quot;Name&quot;, typeof(string));
            dataTable.Columns.Add(&quot;Original Voice Actor&quot;, typeof(string));
            dataTable.Columns.Add(&quot;Animated Debut&quot;, typeof(string));

            var response = ConnectionToES.EsClient().Search&lt;DocumentAttributes&gt;(s =&gt; s
                .Index(&quot;disney&quot;)
                .Type(&quot;character&quot;) 
                .From(0)
                .Size(1000)                
                .Query(q =&gt; q.MatchAll()));

            foreach (var hit in response.Hits)
            {
                dataTable.Rows.Add(hit.Id.ToString(),
                    hit.Source.name.ToString(),
                    hit.Source.original_voice_actor.ToString(),
                    hit.Source.animated_debut.ToString());
            }

            return dataTable;
        }</pre>
<div class="preview">
<pre class="csharp"><span class="cs__keyword">public</span>&nbsp;<span class="cs__keyword">static</span>&nbsp;DataTable&nbsp;getAllDocument()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTable&nbsp;dataTable&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;DataTable(<span class="cs__string">&quot;character&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataTable.Columns.Add(<span class="cs__string">&quot;ID&quot;</span>,&nbsp;<span class="cs__keyword">typeof</span>(<span class="cs__keyword">string</span>));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataTable.Columns.Add(<span class="cs__string">&quot;Name&quot;</span>,&nbsp;<span class="cs__keyword">typeof</span>(<span class="cs__keyword">string</span>));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataTable.Columns.Add(<span class="cs__string">&quot;Original&nbsp;Voice&nbsp;Actor&quot;</span>,&nbsp;<span class="cs__keyword">typeof</span>(<span class="cs__keyword">string</span>));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataTable.Columns.Add(<span class="cs__string">&quot;Animated&nbsp;Debut&quot;</span>,&nbsp;<span class="cs__keyword">typeof</span>(<span class="cs__keyword">string</span>));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;response&nbsp;=&nbsp;ConnectionToES.EsClient().Search&lt;DocumentAttributes&gt;(s&nbsp;=&gt;&nbsp;s&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Index(<span class="cs__string">&quot;disney&quot;</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Type(<span class="cs__string">&quot;character&quot;</span>)&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.From(<span class="cs__number">0</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Size(<span class="cs__number">1000</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Query(q&nbsp;=&gt;&nbsp;q.MatchAll()));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">foreach</span>&nbsp;(var&nbsp;hit&nbsp;<span class="cs__keyword">in</span>&nbsp;response.Hits)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataTable.Rows.Add(hit.Id.ToString(),&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hit.Source.name.ToString(),&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hit.Source.original_voice_actor.ToString(),&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hit.Source.animated_debut.ToString());&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">return</span>&nbsp;dataTable;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<h2>Technicalities:</h2>
<p>This application performs CRUD operation in Elasticsearch. Necessary reference need to add into the project solution and data need to store in Elasticsearch.</p>
<h2>Note</h2>
<ul>
<li>Article detailed the creation of this project: <a href="http://social.technet.microsoft.com/wiki/contents/articles/35095.crud-operation-in-elasticsearch-using-c-and-nest.aspx"  style="margin:0px; padding:0px; outline:0px; border:currentcolor; color:#0076a3; line-height:16.12px; font-family:'Segoe UI','Lucida Grande',Verdana,Arial,Helvetica,sans-serif; font-size:12px; list-style-type:none; background-color:#ffffff">
CRUD Operation in Elasticsearch using C# and NEST </a></li><li>For more about query DSL please see this page <a href="https://code.msdn.microsoft.com/CRUD-Operation-in-d8033948/https://code.msdn.microsoft.com/CRUD-Operation-in-d8033948/https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl.html" >
Query DSL </a></li><li>More about Elasticsearch visit <a href="https://code.msdn.microsoft.com/CRUD-Operation-in-d8033948/https://www.elastic.co/" >
website </a></li></ul>

</div>


    </div>
</body>
</html>
